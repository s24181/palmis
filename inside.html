<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Palmis – Inside</title>

  <!-- Icons / styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons/css/flag-icons.min.css">
  <link rel="stylesheet" href="assets/styles.css">

  <!-- A-Frame for 360° -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/logo/palmis-favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/logo/palmis-favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/logo/palmis-apple-180.png">
  <meta name="theme-color" content="#000000">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow-x: hidden; /* stop horizontal scroll */
    }

    body.inside-page {
      display: flex;
      flex-direction: column;
      background: #000;
    }

    main.inside-main {
      flex: 1;
      min-height: 0;
      display: flex;
      position: relative;
    }

    .inside-scene {
      width: 100%;
      height: 100%;
    }

    /* Walkthrough buttons */
    .view-controls {
      position: absolute;
      left: 50%;
      bottom: 12px;
      transform: translateX(-50%);
      display: flex;
      gap: 6px;
      background: rgba(0,0,0,0.45);
      padding: 6px 10px;
      border-radius: 999px;
      z-index: 20;
      backdrop-filter: blur(6px);
    }

    .view-controls button {
      border: none;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      cursor: pointer;
      background: rgba(255,255,255,0.9);
    }

    .view-controls button:active {
      transform: scale(0.97);
    }

    /* Mobile header tweaks */
    @media (max-width: 768px) {
      .header .container { padding-inline: 10px; }
      .logo { max-height: 32px; }
      .nav a {
        font-size: 0.8rem;
        margin-left: 0.5rem;
      }
      .lang-selector { margin-left: 0.5rem; }
      .header .container { flex-wrap: wrap; }
    }
  </style>
</head>

<body class="inside-page">

  <!-- HEADER -->
  <header class="header">
    <div class="container">
      <a class="brand" href="index.html" aria-label="Palmis — Home">
        <img src="assets/logo/palmis-logo-cropped.jpg" alt="Palmis" class="logo">
      </a>

      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="menu.html">Menu</a>
        <a href="inside.html" class="active">Inside</a>
        <a href="reserve.html">Reserve</a>

        <div class="lang-selector" id="lang">
          <button id="lang-btn" type="button" aria-haspopup="listbox" aria-expanded="false">
            <span id="lang-flag" class="fi fi-gb" aria-hidden="true"></span>
            <span id="lang-code">EN</span>
            <span aria-hidden="true">▾</span>
          </button>

          <ul id="lang-menu" role="listbox" tabindex="-1" hidden>
            <li role="option" data-lang="en" tabindex="0"><span class="fi fi-gb"></span> EN</li>
            <li role="option" data-lang="fr" tabindex="0"><span class="fi fi-fr"></span> FR</li>
            <li role="option" data-lang="pl" tabindex="0"><span class="fi fi-pl"></span> PL</li>
            <li role="option" data-lang="es" tabindex="0"><span class="fi fi-es"></span> ES</li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

  <!-- 360° VIEWER -->
  <main class="inside-main">
    <!-- cursor + raycaster are on the scene so clicks work reliably -->
    <a-scene embedded class="inside-scene"
             cursor="rayOrigin: mouse"
             raycaster="objects: .clickable">
      <a-sky src="assets/palmis_inside_360.jpg" rotation="0 -90 0"></a-sky>

      <!-- single camera -->
      <a-entity id="mainCamera"
                camera
                look-controls="pointerLockEnabled: true"
                position="0 1.6 0">
      </a-entity>

      <!-- INVISIBLE TABLE HOTSPOTS (examples, adjust positions as needed) -->
      <a-entity id="seat-10"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.6; height: 0.6"
                material="opacity: 0; transparent: true"
                position="0 1.0 -2.2">
      </a-entity>

      <a-entity id="seat-12"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.6; height: 0.6"
                material="opacity: 0; transparent: true"
                position="2.2 1.0 -2.3">
      </a-entity>

      <a-entity id="seat-14"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.6; height: 0.6"
                material="opacity: 0; transparent: true"
                position="-2.2 1.0 -2.3">
      </a-entity>

      <a-entity id="seat-13"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.5; height: 0.5"
                material="opacity: 0; transparent: true"
                position="0 1.1 -3.6">
      </a-entity>

      <a-entity id="seat-11"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.5; height: 0.5"
                material="opacity: 0; transparent: true"
                position="2.2 1.1 -3.7">
      </a-entity>

      <a-entity id="seat-15"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.5; height: 0.5"
                material="opacity: 0; transparent: true"
                position="-2.2 1.1 -3.7">
      </a-entity>

      <a-entity id="seat-16"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.45; height: 0.45"
                material="opacity: 0; transparent: true"
                position="-1.5 1.15 -5">
      </a-entity>

      <a-entity id="seat-17"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.45; height: 0.45"
                material="opacity: 0; transparent: true"
                position="0 1.15 -5.2">
      </a-entity>

      <a-entity id="seat-18"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.45; height: 0.45"
                material="opacity: 0; transparent: true"
                position="1.5 1.15 -5">
      </a-entity>

      <a-entity id="seat-20"
                class="clickable seat-hotspot"
                geometry="primitive: plane; width: 0.4; height: 0.4"
                material="opacity: 0; transparent: true"
                position="0 1.2 -6.5">
      </a-entity>
    </a-scene>
<div id="fullview-tip">
  You are in full view — press ESC to return to normal view.
</div>

<style>
  #fullview-tip {
    position: absolute;
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    padding: 8px 14px;
    background: rgba(0,0,0,0.55);
    color: white;
    font-size: 0.9rem;
    border-radius: 6px;
    z-index: 50;
    pointer-events: none; /* Don’t block clicks */
    animation: fadeout 5s forwards;
  }

  @keyframes fadeout {
    0% { opacity: 1; }
    75% { opacity: 1; }
    100% { opacity: 0; }
  }
</style>


    <!-- Walkthrough buttons -->
    <div class="view-controls">
      <button type="button" data-view-rot="0">Main</button>
      <button type="button" data-view-rot="-45">Left row</button>
      <button type="button" data-view-rot="-90">Far left</button>
      <button type="button" data-view-rot="45">Right row</button>
      <button type="button" data-view-rot="90">Terrace</button>
      <button type="button" data-view-rot="180">Back wall</button>
    </div>
  </main>

  <!-- CLICK + VIEW LOGIC -->
  <script>
    window.addEventListener('load', function () {
      // Seat clicks → go to reserve.html?seat=XX
      const seats = document.querySelectorAll('.seat-hotspot');
      seats.forEach(function (seat) {
        seat.addEventListener('click', function () {
          const seatId = seat.getAttribute('id');      // e.g. "seat-10"
          const seatNumber = seatId.replace('seat-', '');
          window.location.href = 'reserve.html?seat=' + encodeURIComponent(seatNumber);
        });
      });

      // View buttons → rotate camera
      const camera = document.querySelector('#mainCamera');
      const viewButtons = document.querySelectorAll('.view-controls button');
      viewButtons.forEach(function (btn) {
        btn.addEventListener('click', function () {
          const yaw = parseFloat(btn.dataset.viewRot) || 0;
          camera.setAttribute('rotation', '0 ' + yaw + ' 0');
        });
      });
    });
  </script>

  <!-- FOOTER -->
  <footer class="footer">
    <p>© 2025 Palmis | Caribbean Restaurant Concept</p>
  </footer>

  <!-- Language selector logic (unchanged) -->
  <script>
  (function(){
    const flagMap = { en:'gb', fr:'fr', pl:'pl', es:'es' };
    const btn   = document.getElementById('lang-btn');
    const menu  = document.getElementById('lang-menu');
    const flag  = document.getElementById('lang-flag');
    const code  = document.getElementById('lang-code');

    const getLang = () => {
      const parts = location.pathname.split('/').filter(Boolean);
      return ['en','fr','pl','es'].includes(parts[0]) ? parts[0] : 'en';
    };
    const getPage = () => (location.pathname.split('/').pop() || 'inside.html');
    const buildUrl = (targetLang) => {
      const cur = getLang(), page = getPage();
      if (cur === 'en') return targetLang === 'en' ? page : `${targetLang}/${page}`;
      if (targetLang === 'en') return `../${page}`;
      if (targetLang === cur)  return page;
      return `../${targetLang}/${page}`;
    };

    function syncUI(){
      const cur = getLang();
      flag.className = `fi fi-${flagMap[cur]}`;
      code.textContent = cur.toUpperCase();
    }

    btn.addEventListener('click', (e)=>{
      e.stopPropagation();
      menu.hidden = !menu.hidden;
    });

    menu.addEventListener('click', (e)=>{
      const li = e.target.closest('li[data-lang]');
      if(!li) return;
      const lang = li.dataset.lang;
      location.href = buildUrl(lang);
    });

    document.addEventListener('click', (e)=>{
      if(!menu.hidden && !btn.contains(e.target) && !menu.contains(e.target)){
        menu.hidden = true;
      }
    });

    syncUI();
  })();
  </script>

</body>
</html>
