<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Palmis – Virtual Tour</title>

  <!-- Icons / styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons/css/flag-icons.min.css">
  <link rel="stylesheet" href="assets/styles.css">

  <!-- A-Frame for 360° -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/logo/palmis-favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/logo/palmis-favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/logo/palmis-apple-180.png">
  <meta name="theme-color" content="#000000">

  <!-- Page-specific styles -->
  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow-x: hidden;
    }

    /* Full-height layout: header on top, footer at bottom */
    body.inside-page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: #000;
    }

    /* Main area fills everything between header & footer */
    main.inside-main {
      flex: 1;
      min-height: 0;
      display: flex;
      background: #000;
    }

.vt-shell {
  flex: 1;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
}

.vt-viewer {
  flex: 1;
  width: 100%;
  height: 100%;
  position: relative;
  background: #000;
  overflow: hidden;
}


    /* Panels are stacked, only one visible */
    .vt-panels {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .vt-panel {
      position: absolute;
      inset: 0;
      display: none;
    }

    .vt-panel.active {
      display: block;
    }

    /* 360° view fills area like hero */
    .vt-360-wrap {
      position: absolute;
      inset: 0;
    }

    .vt-360-wrap a-scene {
      width: 100%;
      height: 100%;
    }

    /* Angle images fill area like hero (cover) */
    .vt-img-wrap {
      position: absolute;
      inset: 0;
      background: #000;
    }

   .vt-img-wrap img {
  position: absolute;
  inset: 0;
  width: 100vw;
  height: calc(100vh - 70px - 60px); /* HEADER and footer space */
  object-fit: cover;
}


    /* Tabs overlaid at bottom of the image */
    .vt-tabs {
      position: absolute;
      left: 50%;
      bottom: 16px;
      transform: translateX(-50%);
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      padding: 6px 10px;
      background: rgba(0,0,0,0.55);
      border-radius: 999px;
      z-index: 30;
      backdrop-filter: blur(8px);
    }

    .vt-tab {
      border: none;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: .8rem;
      cursor: pointer;
      background: rgba(255,255,255,0.08);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.2);
      white-space: nowrap;
    }

    .vt-tab.active {
      background: linear-gradient(90deg,var(--brand,#FCA384),var(--accent,#A93528));
      border-color: transparent;
    }

   /* Clickable zones on angle images */
.table-hotspot {
  position: absolute;
  width: 7%;
  height: 9%;
  border-radius: 8px;
  cursor: pointer;

  /* IMPORTANT: no centering, top/left are now simple */
  transform: none;

  /* keep visible while adjusting */
  background: rgba(255,255,255,0.2);
  border: 1px dashed rgba(255,255,255,0.8);
}

    .table-hotspot:hover {
      background: rgba(255,255,255,0.30);
    }

    /* Tip overlay for 360° */
    #fullview-tip {
      position: absolute;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      padding: 6px 12px;
      background: rgba(0,0,0,0.55);
      color: white;
      font-size: 0.85rem;
      border-radius: 999px;
      z-index: 40;
      pointer-events: none;
      animation: fadeout 5s forwards;
    }

    @keyframes fadeout {
      0% { opacity: 1; }
      75% { opacity: 1; }
      100% { opacity: 0; }
    }

    @media (max-width: 768px) {
      .vt-tabs {
        bottom: 10px;
        padding: 4px 8px;
      }
      .vt-tab {
        font-size: 0.75rem;
        padding: 4px 10px;
      }
    }
  </style>
</head>

<body class="inside-page">

<header class="header">
  <div class="container">
    <!-- Logo / brand -->
    <a class="brand" href="index.html" aria-label="Palmis — Home">
      <img src="assets/logo/palmis-logo-cropped.jpg" alt="Palmis" class="logo">
    </a>

    <!-- Hamburger button (shows on mobile only) -->
    <button class="nav-toggle" type="button" aria-label="Toggle navigation" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Navigation + language -->
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="menu.html">Menu</a>
      <a href="inside.html" class="active">Virtual Tour</a>
      <a href="reserve.html">Reserve</a>

      <div class="lang-selector" id="lang">
        <button id="lang-btn" type="button" aria-haspopup="listbox" aria-expanded="false">
          <span id="lang-flag" class="fi fi-gb" aria-hidden="true"></span>
          <span id="lang-code">EN</span>
          <span aria-hidden="true">▾</span>
        </button>

        <ul id="lang-menu" role="listbox" tabindex="-1" hidden>
          <li role="option" data-lang="en" tabindex="0"><span class="fi fi-gb"></span> EN</li>
          <li role="option" data-lang="fr" tabindex="0"><span class="fi fi-fr"></span> FR</li>
          <li role="option" data-lang="pl" tabindex="0"><span class="fi fi-pl"></span> PL</li>
          <li role="option" data-lang="es" tabindex="0"><span class="fi fi-es"></span> ES</li>
        </ul>
      </div>
    </nav>
  </div>
</header>

<!-- MAIN VIRTUAL TOUR CONTENT -->
<main class="inside-main">
  <section class="vt-shell">

    <div class="vt-viewer">
      <!-- 360 + angle panels -->
      <div class="vt-panels">

       <div class="vt-panels">

  <!-- 360° PANEL -->
  <div class="vt-panel active" id="view-360">
    <div class="vt-360-wrap">
      <a-scene embedded cursor="rayOrigin: mouse" raycaster="objects: .clickable">
        <!-- Leonardo panorama (NEW filename) -->
        <a-sky src="assets/palmis-360.jpg" rotation="0 -90 0"></a-sky>

        <!-- Camera -->
        <a-entity id="mainCamera"
                  camera
                  look-controls="pointerLockEnabled: true"
                  position="0 1.6 0">
        </a-entity>

        <!-- ONLY TABLE 5 CLICKABLE IN 360 -->
        <a-entity id="table5-hotspot"
                  class="clickable"
                  geometry="primitive: plane; width: 0.6; height: 0.6"
                  material="opacity: 0; transparent: true"
                  position="0 1.1 -3">
        </a-entity>
      </a-scene>

      <div id="fullview-tip">
        Drag to look around. Click table 5 to reserve it.
      </div>
    </div>
  </div>

  <!-- ANGLE 1 -->
  <div class="vt-panel" id="view-angle1">
    <div class="vt-img-wrap">
      <img src="assets/angles/angle-1-tables-1-2-6.png" alt="Angle 1">

      <button class="table-hotspot" style="top: 63%; left: 25%;" data-table="1"></button>
      <button class="table-hotspot" style="top: 44%; left: 53%;" data-table="2"></button>
      <button class="table-hotspot" style="top: 70%; left: 72%;" data-table="6"></button>
    </div>
  </div>

  <!-- ANGLE 2 -->
  <div class="vt-panel" id="view-angle2">
    <div class="vt-img-wrap">
      <img src="assets/angles/angle-2-tables-17-19.png"
           alt="Restaurant view with tables 17 and 19">
      <button class="table-hotspot" data-table="17" style="top:60%; left:35%;"></button>
      <button class="table-hotspot" data-table="19" style="top:60%; left:65%;"></button>
    </div>
  </div>

  <!-- ANGLE 3 -->
  <div class="vt-panel" id="view-angle3">
    <div class="vt-img-wrap">
      <img src="assets/angles/angle-3-tables-17-18.png"
           alt="Restaurant view with tables 17 and 18">
      <button class="table-hotspot" data-table="17" style="top:60%; left:37%;"></button>
      <button class="table-hotspot" data-table="18" style="top:60%; left:66%;"></button>
    </div>
  </div>

  <!-- ANGLE 4 -->
  <div class="vt-panel" id="view-angle4">
    <div class="vt-img-wrap">
      <img src="assets/angles/angle-4-tables-21-22.png"
           alt="Restaurant view with tables 21 and 22">
      <button class="table-hotspot" data-table="21" style="top:60%; left:36%;"></button>
      <button class="table-hotspot" data-table="22" style="top:60%; left:66%;"></button>
    </div>
  </div>

</div><!-- /.vt-panels -->


      <!-- Tabs overlay at bottom of the image -->
      <div class="vt-tabs">
        <button class="vt-tab active" data-target="view-360">360° View</button>
        <button class="vt-tab" data-target="view-angle1">Angle 1 — Tables 1, 2, 6</button>
        <button class="vt-tab" data-target="view-angle2">Angle 2 — Tables 17, 19</button>
        <button class="vt-tab" data-target="view-angle3">Angle 3 — Tables 17, 18</button>
        <button class="vt-tab" data-target="view-angle4">Angle 4 — Tables 21, 22</button>
      </div>

    </div><!-- /.vt-viewer -->

  </section>
</main>

<!-- FOOTER -->
<footer class="footer">
  <p>© 2025 Palmis | Caribbean Restaurant Concept</p>
</footer>

<!-- Language selector logic (unchanged) -->
<script>
  (function(){
    const flagMap = { en:'gb', fr:'fr', pl:'pl', es:'es' };
    const btn   = document.getElementById('lang-btn');
    const menu  = document.getElementById('lang-menu');
    const flag  = document.getElementById('lang-flag');
    const code  = document.getElementById('lang-code');

    const getLang = () => {
      const parts = location.pathname.split('/').filter(Boolean);
      return ['en','fr','pl','es'].includes(parts[0]) ? parts[0] : 'en';
    };
    const getPage = () => (location.pathname.split('/').pop() || 'inside.html');
    const buildUrl = (targetLang) => {
      const cur = getLang(), page = getPage();
      if (cur === 'en') return targetLang === 'en' ? page : `${targetLang}/${page}`;
      if (targetLang === 'en') return `../${page}`;
      if (targetLang === cur)  return page;
      return `../${targetLang}/${page}`;
    };

    function syncUI(){
      const cur = getLang();
      flag.className = `fi fi-${flagMap[cur]}`;
      code.textContent = cur.toUpperCase();
    }

    btn.addEventListener('click', (e)=>{
      e.stopPropagation();
      menu.hidden = !menu.hidden;
    });

    menu.addEventListener('click', (e)=>{
      const li = e.target.closest('li[data-lang]');
      if(!li) return;
      const lang = li.dataset.lang;
      location.href = buildUrl(lang);
    });

    document.addEventListener('click', (e)=>{
      if(!menu.hidden && !btn.contains(e.target) && !menu.contains(e.target)){
        menu.hidden = true;
      }
    });

    syncUI();
  })();
</script>

<!-- Hamburger / mobile nav -->
<script>
  (function(){
    const header = document.querySelector('.header');
    const toggle = document.querySelector('.nav-toggle');
    if (!header || !toggle) return;

    toggle.addEventListener('click', function () {
      const open = header.classList.toggle('menu-open');
      toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
    });
  })();
</script>

<!-- Virtual Tour logic: tabs, hotspots, 360 table 5 click -->
<script>
  // Tabs
  (function(){
    const tabs   = document.querySelectorAll('.vt-tab');
    const panels = document.querySelectorAll('.vt-panel');

    tabs.forEach(tab=>{
      tab.addEventListener('click', ()=>{
        const targetId = tab.dataset.target;
        tabs.forEach(t => t.classList.toggle('active', t === tab));
        panels.forEach(p => p.classList.toggle('active', p.id === targetId));
      });
    });
  })();

  // Flat image table hotspots -> reserve.html?table=XX
  (function(){
    const hotspots = document.querySelectorAll('.table-hotspot');
    hotspots.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const table = btn.getAttribute('data-table');
        if (!table) return;
        window.location.href = 'reserve.html?table=' + encodeURIComponent(table);
      });
    });
  })();

  // A-Frame: table 5 in 360 view
  window.addEventListener('load', function () {
    const table5 = document.querySelector('#table5-hotspot');
    if (table5) {
      table5.addEventListener('click', function () {
        window.location.href = 'reserve.html?table=5';
      });
    }
  });
</script>

</body>
</html>
